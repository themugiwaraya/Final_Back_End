<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Startup Ideas</title>
  <link rel="stylesheet" href="styles1.css">
  <style>
    #ideasContainer  {
      text-align: left;    
      white-space: pre-wrap;  
    }  
    /* Example styles */
    #ideasContainer ul {
      list-style: none;
      padding: 0;
    }
    #ideasContainer li {
      border: 1px solid #ddd;
      padding: 10px;
      margin-bottom: 10px;
      text-align: left;
    }
  </style>
</head>
<body>
  <header>
    <nav class="center-nav">
      <a href="index.html">üè† Main Page</a>
      <a href="feedback.html">‚úçÔ∏è Feedback</a>
    </nav>
    <div id="profile-container">
      <img id="profile-icon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMwAAADACAMAAAB/Pny7AAAAMFBMVEXk5ueutLfb3t+nrrHn6eqrsbTh4+S7wMPT1tixt7rKztDBxsi3vL/q7O3Y293Q09Wdj+FKAAAFPklEQVR4nO2c25LbIAxADRZgrv7/vy042SabOyBH8g7npdP2xWckQBDQNA0Gg8FgMBgMBoPBYDAYDAaDwWAwGAwGg92BzKRlQevtL0cFQMvFOe/NhnduSfqQPtlk8SZYdY0Nxi86HswH4uKDFUrcUoR8OlJ4skoQD0zOPsKG5TDRick+E/kvZNMhdECb+Y1KsZmNZm8DsKp3YfkZPSv1x74BtP8gLGeYBwdS+NxlGzl8bT5OsUuqLRNXHVensuk4pmtOg0uGpQ24FpViQ/3l98Da6CLEyi00sNhmGcFsTgMZmgbMhrLM1hvf7lJWT+rP/8Vas1Y+sGE0CYDsictmwyfRwPTKqBCpJc7A0pdkW2i4zM+xW6VAbXEiuv7AlCKNRaIBgkrGUnsU4to7+s9wCA101DHXqEBtUqYyHBfBoeAEj+WiPLmM7qgwb2SCJHaBFWnIZCx1nkFXufwb5WldJt1dll3JGNo8gxTQXHKe0W45O3b+D1C0gwbajpeeyRDv0RDHf5kBNKWLRBz/ZQYg3XAmg+giRJCEMriTmaA9QYOEt/7Ty+CVzBtqIZXBHP9Fhs6l/LqEKjP/JRnayCCnGW1k/tSYwZ7NxjqDJoN2ArBhKcuZXGhiutDWZpP+S1sAzPOMsjmjlcHdaRJvm3t+Mb+Hss7M9PxkfkdIpC6ohwDE47/8bIbmUm440cpg1gCB/NoJoC2byhBnGWqe0f8OCBIrz2gLsxMRK88MvQvCxZkzxCvmiYhzEBg4uOTSGeWGBvm8fCJilDRsrjVNCLeaeMRlwtgIzPRrzIXOn2mUZROYTOqMDPV1ht90JRrxDvOOnpMN8ssMt0D77QYG1fIdrRto+vs/j2jbpjF93dRUcSrBoPB/CDTY8Llqfkt1lcakVH5M9E9fAd+jBP1FxpfA+nFwVGC2Vt4D8rPg5LBwHfpXwLSYt881lfJ8X2j+AvRi5lc6SpmF7yx2C+jk1ROf/O8+8StgXqNXc++j5jnQ/qLUCkzJ2zlT2meUP2d7lJHyEIhxksvqnFsXOcVDdGd4CfyH+ksa2b5cn5HnJjonzv95DPKn5u9PKSeX9yYEW6bibeGxIRjv3ZpSVpu4GxUPmYpEKPOWul87T1OBsiY7LUlyNdpE1hwL+2yB+S2VlXKcXJL8ki5CFjFBPAjGS6WT0MRolotRuq0rU4XHlVAeS3n5YXGiCVG70pWp69xMWOvpWwRBRLtzrqwj7a8VJyc+GO0f68yGbIuTt2GIJmedQNPzSL7es7Qyi0V/txgt9fAuKptOWL94xllUKg5h6lFh/dZGFKR724yt10aY9RuFAUwO98bsMx0vd19Howy7ZtiVjnX7LjsQ/d4ZdmUjwp7BAY38Kuutzn5nnrB8KcMuzH6fNQfAdVWTbahdLqFXtS7EtBH4z1BAftIdcxebeUVONXjftHRHHdxOezF9fehfgzoNxJUwLgWFZxNX0rig2sBCHBdEG9KxfwHlbn1X60JMEK4+fdZ9+SsgvOJGaV6Gguq9ko79RLYL1dehEiT5pHzN3DUJ9LdhxKXnJjdOtz9Eum7Z8oqL6GmDGJkl2UbjJQJIDF2UaQsN0lMSbJrmgIjaIAsN1fQAitu0/INtqGqQXy3j0dLUEfdxPCKq/m0qm8r/nvqdDW5/PFTq3w7g9pPApfbCfc4y6k9+Tm3rQFb7mFuq+wag9sbApvIwHbdxITZz1aBhPWRKq/qawLAsmC/UDRqMTv97UrfScNsv32BrZDgvmQVVJWNm3lR125HMqVs1gTdVLoPBYDAYDAZH4R8eaVEbhZaf7QAAAABJRU5ErkJggg==" alt="Profile">
      <span id="username-display">Guest</span>
      <button id="logout-btn">Logout</button>
    </div>
  </header>
  <div class="container">
    <h1>My Startup Ideas History</h1>
    <button id="clear-history-btn">Clear History</button>
    <div id="ideasContainer">
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const usernameDisplay = document.getElementById("username-display");
      const storedUsername = localStorage.getItem("username");
      usernameDisplay.textContent = storedUsername ? storedUsername : "Guest";
    
      const token = localStorage.getItem("token");
      if (!token) {
        alert("Please log in to view your ideas history.");
        window.location.href = "login.html";
        return;
      }
    
      async function loadMyIdeas() {
        try {
          const response = await fetch("https://final-back-end-fym2.onrender.com/my-ideas", {
            method: "GET",
            headers: {
              "Authorization": "Bearer " + token
            }
          });
    
          if (!response.ok) {
            throw new Error("Error loading ideas history");
          }
    
          const ideas = await response.json();
          const ideasContainer = document.getElementById("ideasContainer");
    
          if (ideas.length === 0) {
            ideasContainer.innerHTML = "<p>No startup ideas found.</p>";
          } else {
            let html = "<ul>";
            ideas.forEach(idea => {
              const categoryText = Array.isArray(idea.category) ? idea.category.join(", ") : idea.category;
              html += `<li>
                          <h3>Idea: ${idea.idea}</h3>
                          <p><strong>ID:</strong> ${idea.idea_id || idea._id}</p>
                       </li>`;
            });
            html += "</ul>";
            ideasContainer.innerHTML = html;
          }
        } catch (error) {
          console.error("Error loading ideas:", error);
          alert("Failed to load ideas history.");
        }
      }
    
      loadMyIdeas();
    
      document.getElementById("logout-btn").addEventListener("click", () => {
        localStorage.removeItem("token");
        localStorage.removeItem("username");
        window.location.href = "login.html";
      });
    
      document.getElementById("clear-history-btn").addEventListener("click", async () => {
        if (!confirm("Are you sure you want to clear your ideas history?")) return;
    
        try {
          const response = await fetch("https://final-back-end-fym2.onrender.com/my-ideas", {
            method: "DELETE",
            headers: {
              "Authorization": "Bearer " + token
            }
          });
    
          if (!response.ok) {
            throw new Error("Error deleting history");
          }
    
          alert("History cleared successfully!");
          document.getElementById("ideasContainer").innerHTML = "<p>No startup ideas found.</p>";
        } catch (error) {
          console.error("Error deleting history:", error);
          alert("Failed to clear ideas history.");
        }
      });
    });
  </script>
</body>
</html>
